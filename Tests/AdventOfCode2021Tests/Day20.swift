@testable import AdventOfCode2021
import Foundation
import XCTest

final class Day20Tests: XCTestCase {
    func testExample() throws {
        let d = Day20()
        let input = """
        ..#.#..#####.#.#.#.###.##.....###.##.#..###.####..#####..#....#..#..##..###..######.###...####..#..#####..##..#.#####...##.#.#..#.##..#.#......#.###.######.###.####...#.##.##..#..#..#####.....#.#....###..#.##......#.....#..#..#..##..#...##.######.####.####.#.#...#.......#..#.#.#...####.##.#......#..#...##.#.##..#...##.#.##..###.#......#.#.......#.#.#.####.###.##...#.....####.#..#..#.##.#....##..#.####....##...##..#...#......#.#.......#.......##..####..#...#.#.#...##..#.#..###..#####........#..####......#..#

        #..#.
        #....
        ##..#
        ..#..
        ..###
        """
        let data = d.parse(input: input)
        XCTAssertEqual(d.partA(input: data), 35)
        XCTAssertEqual(d.partB(input: data), 3351)
    }

    func testReal() {
        let d = Day20()
        let input = """
        ##.##.#.####.#.###.#...##.#..####.##.##..###.####.###.#...###..##.####.##.#..#........####..###....#.#..###.##.######..#####.#.##...#.#.#.####.#.##.#.#.#.#.#....#.###.##...##.####.#.#...#..#.##...##.##....##...##...######.####.#.....####..#.#..#..###..####..###...#.##..#.....###..#.##..#....#.#.#..#.####..#..##...#.##.#......#.###..##...#...##.##...#.##...##.....####.#...........#.#.#..####...###...#.....#.#.#.....###.....###.#.#..##..#.##...####.##..#..#...#.##..#######.#.###..#..##...#.###.#.###.##.##.#..

        ..#..##..#..#.####..##..#..######.####......#...#..#.##..#..###...#...#..##....#.##.......#######..#
        .#.#..####...###.#..##.####..##.##.##.#######.#.#.....##.#..#..#.####.##...#.#..#....##.####.#...#..
        ...#........####..#.##..##...#......##.###.##.###....####.#.....#.....#..#.#...##.#.#.#..##..##..##.
        .#.#.####..#..##....##.##.#.#####.###.##.###....##....#.#.#.#...##.#..#...#....###...#.##.#........#
        ###...#.##.#..###...#..####...#..###..#...###...###..#...##....#.#..#...#..#..##..#..#.######...#.#.
        ##..#.#.###.#..#..#.....#####.#.......#.##.##...#.##.##...##..#.#########.#.....#..##.##.###..#..#.#
        ..##.####.###.#..#...#..#.##...##..####.##.##..#..#...#..#.##.###.#.....#..#.##...####.#.###...##...
        .#.####.##.###..###..###.#....#####.###.#...#..##..##..#.#...#.#.##.##.##.#...#...##.#..#..#...#.#..
        ..###.##..#####.##.#.#..#..##..##.##...##.#....######.#.##.#......#..#.##...###.#.##.#.#######.##..#
        ##..#.#.##..####..#...#.#....##.#.#.#..##.#..#..####.....###..##...#..##.#.#.#.##.....###....#..####
        #.#####..###.#.....##.#.#.#..#.#.#.#...#.#.##..####....#.###.###...#...#.#.##...#..#.#.#.....###..#.
        .#.#.#...##..##..##.##...###...#..#.#...#.#..#####......###########.##...######....#..#.#..#.#..#...
        ##.########...#..##..#..####..##...#.#.....##.###..#.##.#....##..#.#.###..###..###.##.#.####...###.#
        ###...##.#...##.#..#.###..###.#..##.#.#..#..#...#.###.##...#..###.#.#....#.#.##.####..####..##.#.###
        .#..#.#.##.....#.###...#.###....##.####...##.#........###..#.###.#.#.#.###..#.#.####.##.##.....#.##.
        ##.#.##..###.#....#.#...#.#..####.###..#...#.#...##..###.#...##..#...#..#.####...#..##..##......#...
        #.###.####.##.#..#..........#........#########.##..####.#..##.#.#...#...#...##.##..#..######.....#.#
        #####.....##.#####..###.###.###.####........#####.###.#.######.##.#.##...####..#..##.##.####.....#.#
        ..##..#.##...#.##.#.#....#...#.......##........####.##...######.#.#...######..##..#..#.#.#..###.##..
        ...######..##...###.#...##...#.###.###..#.#..##....#..##..####..#..###...#.......#.#.#.#.##...###.##
        ###..#.####....###.#.#..#..#..####....##.#.#..#.#.#.#...##..##.#.##..##....#..##..#.####.#.........#
        #......#.#....#.######..#.#...##...#.#.#.#...##......###...#....#..######..#.#.###..#..####.##.###.#
        .######..###....#...##..###.##........###...#..#.###...#...#..#..###.#..#..##....####.#.#.#.#...##..
        .....##.#.###..#.#.#..###.##.#.######.#.####.#.##..##...#..####.#.###..##.##..#..##.####.##...#.#...
        #.#...#.#..##........##########.#.#.#.#.##..#.##.##..#..#####...........#..#.###...#####.###....##.#
        .##.##.###...#.##.##.#..#.#...#.##....#.##.##.##..#.#.#..##...#######.#.#...#.####.##..#.#...##..###
        ##.#..#..#.#..#.#...###.#..#.#...#.####.#..#...##....###.###.#.#..###.#..###..##...#..###.####...#..
        ##..##..#..#...##.##...#...#....##..###.#.#.....#.####..#......##.###.###...###...#####.###..#..###.
        ....###...#......#####....#.#.#..#..#...#...####.########..##...#..######.###.#.#.....###....#.#####
        .###..#.#.........####.##.##..#.#..#..####.##.##........#..###..###.#.....##..##..##.#..###.##.###.#
        .#.####.###.#..#...#####.###.#....##.#.....##.##.#...###..#...#.#...##.####..##..#.#..##.#.#....###.
        ##.#.###..##..#.#.####.##.##.####.##......####....#####.##.###..#.####...#.####..####.##.#......##..
        #.#.#.##.#..#..####.#.#..##..#.##..#..#####......#.#..###.#.####.##.##..####...#..###.#...#..##.#...
        ###..#####....#...#...####.....#####...####.###...#.#..##.###.#.##.##.#.###..##.#.####.......#.#.#.#
        .##.#...##..#.##.##.....###.##..#.###....##..####.##.#........##.#..##....###.....###...#..##.....#.
        .#####..#######.##.####..#...#.##.######..#.#...#.#.##.###.##........#####......#####..#.#.##...####
        .#.#.##......####...##..######...###..##..#.#..#...###..##.#.#...######.####.#.........####...#...#.
        ##.#...##.#.#.#...#..##.###..###....###..#.#...##.###...#.###..#.##.##.##..##.##.#..#####.#..####..#
        ##.#.#.....#.#..#.####.###.....###.#.......#..#..##..##.##.#.##..###..#.#..#.#####.####..####.#####.
        .#..##..#.##..#...###..#...#..#......#.#..#.#######.#.#.####.###...#####....#.###.###.#.##...###.#.#
        ###.#....##.###.###.###.##.###..#######....#####..###.#..####...#...#.##.#...#.......#.....##.#.####
        #.##.#.#########...##..###..#.####...#.####.#...##.###.#......###.###.##.####..#.#.##.##.#..###..###
        .##......##.##.....#####.....#.##..##.#.#.#.##.##..###..######.###.#.###..#...##.####...##..#..####.
        ....###.#####...##.####.#...#....##.#..#.###.#.###...##....#.##...###..##..........###..#.###.####.#
        ..#.###.#.#.#.#..##....#####..#..####.#######.#..#####.#.#.#####..####.##.#..#.#.###..##.####......#
        #.#.##.....#..##....##.#.#.##....#....##..####.##..###....##.##.#..##.######..#...#...#.###...#...#.
        ##...##.#....#.####..######...#...#.###....###....#.####.#...#...####.##.#.#.##....######.###.###..#
        #.###.#...##...##..###.#.##..#..#..##....####.#.##.#.####..##..#..#...#..##.#####.#..#.......##.##.#
        ..#...##.#.....#.##.###.........#.###....##..#........#....###.##.###.###.....#..####.##....#...#..#
        #.###.#.#.#.....##.#.#...##.####.##....##.##..#...##..###.#####..###.#.#.#####.#.###...#####.....##.
        .##..##..#.####.#####...###.#####..#..####..#..###.##..#....##.#...#.#..##.#.#.#....#....#...#..#..#
        #.....#..#..#.#.#...#.##.#.###.#.##..##.#.#....#####...#.#..#.#...........#..##.....###.##.###.##..#
        #.#..#..##..#..##..#..#.##.##..####....#####..###.#...##.##....#...##.##.#.#.##.##.#.##...#......###
        ..#...#..#.##.#.###..####..##....#....#.##.#.##.####.#.#.###..#.##..#..####..#..#..#..##.#.##..#..#.
        .....##.##....####....##..##...##..###.##...#..##..#..#....#...###..#.....#.....#######.#..###.#.##.
        #.#.#..###.#.#.##.#.#....#.#.##.###.##.#.##.#####..#.#.#..####..#...####..###.##...#.#####....#####.
        ##..#....####.#.#..#....#.##.#....##.#....#.#..##..#...#..#.#..#...#.#.#..###..####..#..#.#..#...#..
        .#....#.##..##.###.##..#....#...#..#.#.#..###..#......#...#####.#..#.......##..######...#.###.#.....
        #.#...#...###.#####.#..#.....#...#...####..#.#.##..##...#......#....#.###.######......#.###.#.#.####
        .#####.#.#.##..##.##.#...##.#.##.#...###..#######..#..#.###....#....#.....#.#.#.#...#.#.....##.###..
        ##........##...#.###.##....###...#..#...#.##..#######...####..#.#.#...###.###..####.##..#.#.####..##
        #..#.#.########..##.....##.##...#.#.#.##.###.#...###.##.###..###.#.####....###....#..##.#....##.....
        ##########.##########.###.....#.....####..##.#.#.######.#.#....####.##.##...#...#..#.##.##...#.....#
        .......##.####......##..#...#..#..##........####.#.#.#.#.##..##...###.##...##....#.##.####.####.....
        #####.....#..#..##.######...#.....###.####.#.#####..#####.#.##..#.#.##.#..#.#..##.#..######.#..#..##
        #....##.#.#.####..###.##.#.###.##..##....##..##..........###.#..######....#..#.##.#.####..##..##..##
        ...##.####.#..#..####.#....##..##..##.....#########..###..###.#.#..##.#.##..#...##.#..#.#.#.########
        #######..#..#.###....###....##..#####.#####.####.#######.###.#..#...#..#..##.#.####....#..#.#..##.#.
        .##.#.#.#.#..#.####..#..##.#..#..##..#.##..#..#.##..#...#..#.###..#.#..##..##.#.....##...#....##.#..
        ##.#.#.#.#.#.####.##..#.#..#.###.###..#..###...#..##.##.####..#.....####...#....###..####.##.#..#...
        ....##..###.##.###.#..####.#.##.##.##.##.#.#.####..#..##..#..#...####.#######...##..###.##.##..##.#.
        ...#####..##.###.#.#...#.##...####...##..###.#.#####....##.##....###.#..#.#..##....#.#####.##.#..###
        .#.#.#..#..#..##.###.###..#.#..###....##..##.#.....#..#.#....#####......#####.#.##...#..#....##..#.#
        ...#.######..####..##.....#.#....#####.#...#....#.#.#.#...####.#.#.#.###.###...##..###.###.###.##...
        #..####.#####.###.#....#####.#.###.###.##.###...##.##....####.#.##..#.#.#..#....#..#..#.#...######..
        .##..##..#####.#..###..#.##....##.#....##..##.#..##.#.###.....##..##.#...#..#.##.#.###.###.#......##
        ####.#.#..#######.###.#..#.###.#.#.#.##..#..#...#####.##....#.##.####.#..##...#.#....#....##..#..#.#
        .......#.#.#...##.#...#.#.#..###....#..##..###..#.#.#.#.##.#....#....#..#..##......###.##.#..#...##.
        #.##.###...#..#...#.#.##..####.......#.......###...######...##.#.....#..#............#.#.#....###..#
        ......#.#.#..####....##.###.##...###..#.#.###.#####..####.###.#.##..#....##.##....#.#.#.#.#.##..#.##
        ....#.#.......##..##..#.##...#...#.##...#.#.##.#.#...###..#####.###.#.##.....##..#..#.#.#.##...#.#.#
        #..###..#.#.#.#..#.#....#.##..##.#..#..###..#.#.....###..#####.#######.#...#.####.#..#.#..#######..#
        ...#.#.##...#...###..#######..##.#.#.#.###.#.##.#.##..####..#..###..#.##.##.######.#####.####.#.#..#
        .###.###.###.###..######.#.#..###..#.#.....#.#...##..##.#.###...##....#.##.##.###...#.#.#..##.#.#.##
        ##..#..#..#.###.##....####....##.#..#######.#..#.###..#.####.#####...#..#.##......#...#.###..#...##.
        #.###..##.#.#....#.##..##.##.#.#.###.##..#......####.###....###..#.#.##...#.#.#.#.#..##....##...#.#.
        ...#.###..#..#.##.###.#...#..#..#.##.##....#.#.#.#..###...#.###..#..#..####...#....#..####..#...##..
        .......##..#...###.#.....#...###..##.###.##..#..#.#...#.###.#.#.###.#.......#####.##..##......#.##.#
        .#.....#.###.#.#####..#.##.#.#.#.#.###..#.#..##.###..##.##..#....#.###....#....#..#..###..#..#.##.##
        #####.#.##.###.##...#.##.##.#.#....#.##.#.#..#.#.##...##.########..#.#....#####.#######........#..#.
        #...###..####.##.#.#####..##.###...###.##..#..##...##.....####...#.......#....#.#.###..#......#..##.
        ....##...####..##.###..###......###.#..#....####...###....#.#.#..#.#....#####.....##...#.......#.#..
        .....#.#.#.##..####.#...#...##.###..##.#.##.....###.##.##..#.##.##..#.#....#.##.####..##.#.####.##..
        .##..###...##.#.#..#.#.#..###...#...##.##.##.#.#....###..##...###...#..#.#.##..##..#..#..#.#.##.....
        ###..#......###.##..##.###...#.##.######.###..#...##.#....#..####..###...###.#.#######.#.####.#.##..
        #.#.#.#####.##...#..#.#...#......##.###..#.#...###......#..#..###..#..#.#.#####.#....##.#.###....##.
        ...##...##.#....#.##.#..####...#.##.##..#.######..#..#######.#...####.####....##.##.#.....#..####.##
        #...##.#.#.....##..##.###..#.#..#.#.##.....#.#..#.#.#..#.....#.###.#.#.#.#...###..#..#.#.###..#.#.#.
        ..#.#..#.##.#.##.####.#.##.#..##.##.#...#.....##.#..##.#..##..#####.#......#.##....#...##..####.###.
        #...###..#####...#...##.##......#.#......#..#.###...#....####.##.####......##..#..###...##.######.##
        """
        let data = d.parse(input: input)
        XCTAssertEqual(d.partA(input: data), 5391)
        XCTAssertNotEqual(d.partA(input: data), 5229)
        XCTAssertNotEqual(d.partA(input: data), 5513)
        XCTAssertNotEqual(d.partA(input: data), 5547)
        XCTAssertEqual(d.partB(input: data), 16383)
    }
}
